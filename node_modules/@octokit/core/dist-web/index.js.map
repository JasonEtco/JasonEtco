{"version":3,"file":"index.js","sources":["../dist-src/version.js","../dist-src/index.js"],"sourcesContent":["export const VERSION = \"2.5.3\";\n","import { getUserAgent } from \"universal-user-agent\";\nimport { Collection } from \"before-after-hook\";\nimport { request } from \"@octokit/request\";\nimport { withCustomRequest } from \"@octokit/graphql\";\nimport { createTokenAuth } from \"@octokit/auth-token\";\nimport { VERSION } from \"./version\";\nlet Octokit = /** @class */ (() => {\n    class Octokit {\n        constructor(options = {}) {\n            const hook = new Collection();\n            const requestDefaults = {\n                baseUrl: request.endpoint.DEFAULTS.baseUrl,\n                headers: {},\n                request: Object.assign({}, options.request, {\n                    hook: hook.bind(null, \"request\"),\n                }),\n                mediaType: {\n                    previews: [],\n                    format: \"\",\n                },\n            };\n            // prepend default user agent with `options.userAgent` if set\n            requestDefaults.headers[\"user-agent\"] = [\n                options.userAgent,\n                `octokit-core.js/${VERSION} ${getUserAgent()}`,\n            ]\n                .filter(Boolean)\n                .join(\" \");\n            if (options.baseUrl) {\n                requestDefaults.baseUrl = options.baseUrl;\n            }\n            if (options.previews) {\n                requestDefaults.mediaType.previews = options.previews;\n            }\n            if (options.timeZone) {\n                requestDefaults.headers[\"time-zone\"] = options.timeZone;\n            }\n            this.request = request.defaults(requestDefaults);\n            this.graphql = withCustomRequest(this.request).defaults({\n                ...requestDefaults,\n                baseUrl: requestDefaults.baseUrl.replace(/\\/api\\/v3$/, \"/api\"),\n            });\n            this.log = Object.assign({\n                debug: () => { },\n                info: () => { },\n                warn: console.warn.bind(console),\n                error: console.error.bind(console),\n            }, options.log);\n            this.hook = hook;\n            // (1) If neither `options.authStrategy` nor `options.auth` are set, the `octokit` instance\n            //     is unauthenticated. The `this.auth()` method is a no-op and no request hook is registred.\n            // (2) If only `options.auth` is set, use the default token authentication strategy.\n            // (3) If `options.authStrategy` is set then use it and pass in `options.auth`. Always pass own request as many strategies accept a custom request instance.\n            // TODO: type `options.auth` based on `options.authStrategy`.\n            if (!options.authStrategy) {\n                if (!options.auth) {\n                    // (1)\n                    this.auth = async () => ({\n                        type: \"unauthenticated\",\n                    });\n                }\n                else {\n                    // (2)\n                    const auth = createTokenAuth(options.auth);\n                    // @ts-ignore  ¯\\_(ツ)_/¯\n                    hook.wrap(\"request\", auth.hook);\n                    this.auth = auth;\n                }\n            }\n            else {\n                const auth = options.authStrategy(Object.assign({\n                    request: this.request,\n                }, options.auth));\n                // @ts-ignore  ¯\\_(ツ)_/¯\n                hook.wrap(\"request\", auth.hook);\n                this.auth = auth;\n            }\n            // apply plugins\n            // https://stackoverflow.com/a/16345172\n            const classConstructor = this.constructor;\n            classConstructor.plugins.forEach((plugin) => {\n                Object.assign(this, plugin(this, options));\n            });\n        }\n        static defaults(defaults) {\n            const OctokitWithDefaults = class extends this {\n                constructor(...args) {\n                    const options = args[0] || {};\n                    super(Object.assign({}, defaults, options, options.userAgent && defaults.userAgent\n                        ? {\n                            userAgent: `${options.userAgent} ${defaults.userAgent}`,\n                        }\n                        : null));\n                }\n            };\n            return OctokitWithDefaults;\n        }\n        /**\n         * Attach a plugin (or many) to your Octokit instance.\n         *\n         * @example\n         * const API = Octokit.plugin(plugin1, plugin2, plugin3, ...)\n         */\n        static plugin(p1, ...p2) {\n            var _a;\n            if (p1 instanceof Array) {\n                console.warn([\n                    \"Passing an array of plugins to Octokit.plugin() has been deprecated.\",\n                    \"Instead of:\",\n                    \"  Octokit.plugin([plugin1, plugin2, ...])\",\n                    \"Use:\",\n                    \"  Octokit.plugin(plugin1, plugin2, ...)\",\n                ].join(\"\\n\"));\n            }\n            const currentPlugins = this.plugins;\n            let newPlugins = [\n                ...(p1 instanceof Array\n                    ? p1\n                    : [p1]),\n                ...p2,\n            ];\n            const NewOctokit = (_a = class extends this {\n                },\n                _a.plugins = currentPlugins.concat(newPlugins.filter((plugin) => !currentPlugins.includes(plugin))),\n                _a);\n            return NewOctokit;\n        }\n    }\n    Octokit.VERSION = VERSION;\n    Octokit.plugins = [];\n    return Octokit;\n})();\nexport { Octokit };\n"],"names":[],"mappings":"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"}